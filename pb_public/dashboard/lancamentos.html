<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
    <title>Lan√ßamentos - Planilha Eh tudo</title>
  <script type="module" crossorigin src="/assets/lancamentos.js"?v=1768008743044></script>
  <link rel="modulepreload" crossorigin href="/assets/auth.js">
  <link rel="modulepreload" crossorigin href="/assets/toast.js">
  <link rel="modulepreload" crossorigin href="/assets/user-menu.js">
  <link rel="modulepreload" crossorigin href="/assets/sheets.js">
  <link rel="modulepreload" crossorigin href="/assets/fab-menu.js">
  <link rel="stylesheet" crossorigin href="/assets/toast.css"?v=1768008743044>
  <link rel="stylesheet" crossorigin href="/assets/lancamentos.css"?v=1768008743044>
  <link rel="stylesheet" crossorigin href="/assets/main.css"?v=1768008743044>
</head>

<body>
    <!-- NAV: menu din√¢mico -->
    <nav>
        <a href="/" class="brand">
            <span>Planilha Eh Tudo</span>
        </a>
        <input id="bmenub" type="checkbox" class="show">
        <label for="bmenub" class="burger pseudo button">menu</label>
        <div class="menu user-menu" id="menu-user" role="menubar" aria-label="Menu do usu√°rio"></div>
    </nav>

    <!-- Container principal com menu lateral -->
    <div class="app-container">
        <!-- Menu lateral fixo -->
        <aside class="sidebar-menu">
            <a href="index.html" title="Dashboard">
                <span class="menu-icon">üè†</span>
                <span class="menu-text">Dashboard</span>
            </a>
            <a href="lancamentos.html" class="active" title="Lan√ßamentos">
                <span class="menu-icon">üìã</span>
                <span class="menu-text">Lan√ßamentos</span>
            </a>
            <a href="categorias.html" title="Categorias">
                <span class="menu-icon">üè∑Ô∏è</span>
                <span class="menu-text">Categorias</span>
            </a>
            <a href="/pwa" title="Celular">
                <span class="menu-icon">üì±</span>
                <span class="menu-text">Celular</span>
            </a>
        </aside>

        <!-- Conte√∫do principal rol√°vel -->
        <main class="main-content">
            <section class="section section-light dashboard-main">
                <div class="container">
                    <div class="lancamentos__header lancamentos-header">
                        <h2 class="lancamentos__title">Lan√ßamentos</h2>
                        <p class="lancamentos__description">Visualize e gerencie todos os seus lan√ßamentos financeiros.</p>

                        <div class="lancamentos__actions lancamentos-actions">
                            <button id="refreshEntriesBtn" class="button">
                                üîÑ Atualizar
                            </button>
                        </div>
                    </div>

                    <!-- Indicador de loading -->
                    <div id="loadingIndicator" class="lancamentos__loading loading-indicator" style="display: none;">
                        <div class="lancamentos__spinner loading-spinner"></div>
                        <p>Carregando lan√ßamentos...</p>
                    </div>

                    <!-- Barra de pesquisa -->
                    <div class="lancamentos__search search-container">
                        <div class="lancamentos__search-wrapper search-input-wrapper">
                            <input type="text" id="searchInput"
                                placeholder="Pesquisar lan√ßamentos por data, valor, descri√ß√£o, categoria ou conta..."
                                class="lancamentos__search-input search-input" autocomplete="off">
                            <button id="clearSearchBtn" class="lancamentos__search-clear clear-search-btn" style="display: none;"
                                title="Limpar pesquisa">
                                ‚úï
                            </button>
                        </div>
                        <div id="searchResults" class="lancamentos__search-results search-results">
                            <span id="searchCount"></span>
                        </div>
                    </div>

                    <!-- Controles de ordena√ß√£o -->
                    <div class="lancamentos__sorting sorting-controls">
                        <div class="lancamentos__sorting-controls">
                            <div class="lancamentos__sorting-group form-group">
                                <label for="sortSelect" class="lancamentos__sorting-label">Ordenar por:</label>
                                <select id="sortSelect" class="lancamentos__sorting-select">
                                    <option value="original" selected>Linhas da Planilha</option>
                                    <option value="budget_date">Or√ßamento > Data</option>
                                    <option value="date">Data</option>
                                </select>
                            </div>
                            <div class="lancamentos__sorting-group form-group">
                                <label class="lancamentos__sorting-checkbox checkable">
                                    <input type="checkbox" id="showConsolidatedCheck" name="showConsolidated" checked>
                                    <span class="checkable">Mostrar lan√ßamentos consolidados</span>
                                </label>
                            </div>
                            <div class="lancamentos__sorting-group form-group">
                                <label class="lancamentos__sorting-checkbox checkable">
                                    <input type="checkbox" id="showFutureCheck" name="showFuture">
                                    <span class="checkable">Mostrar lan√ßamentos futuros</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Container principal dos lan√ßamentos -->
                    <div id="entriesContainer" class="lancamentos__container entries-container">
                        <!-- Conte√∫do ser√° carregado via JavaScript -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Bot√£o flutuante de filtrar -->
    <button id="openFilterPanel" class="filter-fab-button" aria-label="Filtrar lan√ßamentos" title="Filtrar lan√ßamentos">
        üîΩ
    </button>

    <!-- Bot√£o flutuante de adicionar lan√ßamento -->
    <button id="openEntryModal" class="fab-button" aria-label="Adicionar lan√ßamento">
        +
    </button>

    <!-- Painel de Filtros -->
    <aside id="filterPanel" class="filter-panel" role="dialog" aria-labelledby="filterPanelTitle" aria-hidden="true">
        <div class="filter-panel__overlay" id="filterPanelOverlay"></div>
        <div class="filter-panel__content">
            <div class="filter-panel__header">
                <h3 id="filterPanelTitle" class="filter-panel__title">Filtros</h3>
                <button id="closeFilterPanel" class="filter-panel__close" aria-label="Fechar filtros">
                    ‚úï
                </button>
            </div>

            <div class="filter-panel__body">
                <form id="filterForm" class="filter-form">
                    <!-- Filtro por Conta -->
                    <div class="filter-form__group">
                        <label for="filterConta" class="filter-form__label">
                            Conta
                        </label>
                        <select id="filterConta" name="conta" class="filter-form__select">
                            <option value="">Todas as contas</option>
                        </select>
                    </div>

                    <!-- Filtro por Data (Intervalo) -->
                    <div class="filter-form__group">
                        <label for="filterDataInicio" class="filter-form__label">
                            Data in√≠cio
                        </label>
                        <input 
                            type="date" 
                            id="filterDataInicio" 
                            name="dataInicio" 
                            class="filter-form__input"
                            aria-describedby="filterDataInicioHelp">
                        <small id="filterDataInicioHelp" class="filter-form__help">
                            Deixe vazio para incluir todas
                        </small>
                    </div>

                    <div class="filter-form__group">
                        <label for="filterDataFim" class="filter-form__label">
                            Data fim
                        </label>
                        <input 
                            type="date" 
                            id="filterDataFim" 
                            name="dataFim" 
                            class="filter-form__input"
                            aria-describedby="filterDataFimHelp">
                        <small id="filterDataFimHelp" class="filter-form__help">
                            Deixe vazio para incluir todas
                        </small>
                    </div>

                    <!-- Filtro por Or√ßamento -->
                    <div class="filter-form__group">
                        <label for="filterOrcamento" class="filter-form__label">
                            Or√ßamento
                        </label>
                        <select id="filterOrcamento" name="orcamento" class="filter-form__select">
                            <option value="">Todos os or√ßamentos</option>
                        </select>
                    </div>
                </form>
            </div>

            <div class="filter-panel__footer">
                <button type="button" id="clearFiltersBtn" class="button">
                    Limpar filtros
                </button>
                <button type="button" id="applyFiltersBtn" class="button primary">
                    Aplicar filtros
                </button>
            </div>
        </div>
    </aside>

    <!-- Modal de divis√£o de parcelas -->
    <div id="splitModal" class="modal" style="display:none; align-items:center; justify-content:center;">
        <div class="modal-content solution-card"
            style="max-width:500px; width:95%; position:relative; text-align:left;">
            <button class="modal-close" onclick="lancamentosManager.closeSplitModal()"
                style="position:absolute; top:10px; right:10px; background:transparent; border:none; font-size:1.5rem; cursor:pointer;">√ó</button>
            <h3 style="margin-top:0; text-align:center;">Dividir em Parcelas</h3>

            <div style="margin-bottom:1rem; padding:1rem; background:#f8f9fa; border-radius:4px;">
                <h4 style="margin:0 0 0.5rem;">Lan√ßamento atual:</h4>
                <div><strong>Descri√ß√£o:</strong> <span id="splitDescription"></span></div>
                <div><strong>Valor:</strong> <span id="splitValue"></span></div>
                <div><strong>Data:</strong> <span id="splitDate"></span></div>
            </div>

            <form id="splitForm" onsubmit="return false;" style="margin-top:1rem;">
                <div class="form-group">
                    <label for="splitInstallments">N√∫mero de parcelas *</label>
                    <input type="number" id="splitInstallments" min="2" max="99" value="2" required>
                    <small style="color:#666;">Entre 2 e 99 parcelas</small>
                </div>

                <div id="splitPreview"
                    style="margin:1rem 0; padding:1rem; background:#e8f5e8; border-radius:4px; display:none;">
                    <h4 style="margin:0 0 0.5rem;">Resultado da divis√£o:</h4>
                    <div><strong>Valor por parcela:</strong> <span id="splitInstallmentValue"></span></div>
                    <div style="margin-top:0.5rem;">
                        <strong>Parcelas:</strong>
                        <ul id="splitInstallmentsList" style="margin:0.5rem 0 0; padding-left:1rem;"></ul>
                    </div>
                </div>

                <div class="form-actions" style="margin-top:1.5rem; gap:1rem;">
                    <button type="button" class="button"
                        onclick="lancamentosManager.closeSplitModal()">Cancelar</button>
                    <button type="button" class="button primary" onclick="lancamentosManager.confirmSplit()"
                        id="splitConfirmBtn">Dividir Lan√ßamento</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirma√ß√£o de exclus√£o -->
    <div id="deleteModal" class="entry-modal" style="display:none;">
        <div class="entry-modal__content">
            <button class="entry-modal__close" onclick="lancamentosManager.closeDeleteModal()">√ó</button>
            <h3 class="entry-modal__title">Confirmar Exclus√£o</h3>
            
            <div class="modal-body">
                <p style="margin-top:0; margin-bottom:1rem; color: var(--text-color, #333);">Tem certeza que deseja excluir o lan√ßamento abaixo?</p>
                
                <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <div style="display: grid; gap: 0.5rem;">
                        <div style="display: flex; gap: 0.5rem;">
                            <strong style="color: #666; min-width: 80px;">#:</strong>
                            <span id="deleteRowNumber" style="color: var(--text-color, #333);"></span>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <strong style="color: #666; min-width: 80px;">Data:</strong>
                            <span id="deleteDate" style="color: var(--text-color, #333);"></span>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <strong style="color: #666; min-width: 80px;">Valor:</strong>
                            <span id="deleteValue" style="color: var(--text-color, #333); font-weight: 600;"></span>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <strong style="color: #666; min-width: 80px;">Descri√ß√£o:</strong>
                            <span id="deleteDescription" style="color: var(--text-color, #333);"></span>
                        </div>
                    </div>
                </div>
                
                <p style="font-size: 0.85rem; color: #999; margin: 0; padding: 0.75rem; background: #fff3cd; border-left: 3px solid #ffc107; border-radius: 4px;">
                    ‚ö†Ô∏è A opera√ß√£o limpa a linha correspondente na planilha Google Sheets. N√£o h√° como desfazer.
                </p>
            </div>
            
            <div class="entry-modal__form-actions">
                <button type="button" class="button" onclick="lancamentosManager.closeDeleteModal()">Cancelar</button>
                <button type="button" id="deleteConfirmBtn" class="button danger"
                    onclick="lancamentosManager.confirmDelete()">üóëÔ∏è Excluir</button>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Planilha Eh Tudo. Simplificando suas finan√ßas.</p>
        </div>
        <p>
            <small>Produzido por
                <a href="https://www.ehtudo.app">Eh!Tudo.app</a></small>
        </p>
    </footer>

</body>

</html>
