import{i as p,r as g,a as y}from"./auth.js";/* empty css     */let m=!1;function v(){const s=document.getElementById("registerForm"),t=document.getElementById("email"),i=document.getElementById("password"),n=document.getElementById("confirmPassword"),e=document.getElementById("submitButton"),o=document.getElementById("buttonText"),a=document.getElementById("buttonLoading"),d=document.getElementById("errorMsg"),u=document.getElementById("successMsg");return!s||!t||!i||!n||!e||!o||!a||!d||!u?(console.error("Elementos do formulário de registro não encontrados"),null):{form:s,emailInput:t,passwordInput:i,confirmPasswordInput:n,submitButton:e,buttonText:o,buttonLoading:a,errorMsg:d,successMsg:u}}function c(s,t){s.errorMsg.textContent=t,s.errorMsg.style.display="block",s.successMsg.style.display="none"}function w(s,t){s.successMsg.textContent=t,s.successMsg.style.display="block",s.errorMsg.style.display="none"}function r(s){s.errorMsg.style.display="none",s.successMsg.style.display="none"}function l(s,t){m=t,s.submitButton.disabled=t,s.emailInput.disabled=t,s.passwordInput.disabled=t,s.confirmPasswordInput.disabled=t,t?(s.buttonText.style.display="none",s.buttonLoading.style.display="inline"):(s.buttonText.style.display="inline",s.buttonLoading.style.display="none")}function b(s){return s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?{valid:!0}:{valid:!1,message:"E-mail inválido"}:{valid:!1,message:"E-mail é obrigatório"}}function E(s){return s?{valid:!0}:{valid:!1,message:"Senha é obrigatória"}}function I(s,t){return t?s!==t?{valid:!1,message:"As senhas não coincidem"}:{valid:!0}:{valid:!1,message:"Confirmação de senha é obrigatória"}}function M(s){const t=b(s.email);if(!t.valid)return t;const i=E(s.password);if(!i.valid)return i;const n=I(s.password,s.passwordConfirm);return n.valid?{valid:!0}:n}async function L(s){var n;if(m)return;r(s);const t={email:s.emailInput.value.trim(),password:s.passwordInput.value,passwordConfirm:s.confirmPasswordInput.value},i=M(t);if(!i.valid){c(s,i.message||"Erro de validação");return}l(s,!0);try{await window.pb.collection("users").create({email:t.email,emailVisibility:!0,password:t.password,passwordConfirm:t.passwordConfirm}),w(s,"Conta criada com sucesso! Redirecionando..."),setTimeout(()=>{y()},1500)}catch(e){console.error("Erro ao registrar:",e);let o="Erro ao criar conta. Tente novamente.";if((n=e==null?void 0:e.response)!=null&&n.data){const a=e.response.data;a.email?o="Este e-mail já está cadastrado":a.password?o="Senha inválida. Use no mínimo 8 caracteres":a.passwordConfirm?o="As senhas não coincidem":a.message&&(o=a.message)}else e!=null&&e.message&&(o=e.message);c(s,o),l(s,!1)}}function B(s){s.form.addEventListener("submit",async t=>{t.preventDefault(),await L(s)})}function h(s){s.emailInput.addEventListener("input",()=>r(s)),s.passwordInput.addEventListener("input",()=>r(s)),s.confirmPasswordInput.addEventListener("input",()=>r(s))}function f(){if(p()){g();return}const s=v();if(!s){console.error("Não foi possível inicializar a página de registro");return}B(s),h(s),console.log("✅ Página de registro inicializada")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f();
