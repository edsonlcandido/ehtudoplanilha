import{c as i,i as u,r as c,p as g}from"./auth.js";/* empty css     */import{A as r}from"./auth-oauth.js";let e;async function a(){if(i.isDevelopment&&console.log("[Login] Página inicializada em modo desenvolvimento"),r.isOAuthCallback()){i.isDevelopment&&console.log("[Login] Detectado callback OAuth, processando..."),await r.handleOAuthCallback();return}if(u()){c();return}if(e={form:document.getElementById("login-form"),emailInput:document.getElementById("email"),passwordInput:document.getElementById("password"),loginBtn:document.getElementById("login-btn"),googleLoginBtn:document.getElementById("google-login-btn"),errorMsg:document.getElementById("errorMsg"),successMsg:document.getElementById("successMsg")},!m()){console.error("[Login] Elementos do DOM não encontrados");return}f()}function m(){return!!(e.form&&e.emailInput&&e.passwordInput&&e.loginBtn&&e.googleLoginBtn&&e.errorMsg&&e.successMsg)}function f(){e.form.addEventListener("submit",p),e.googleLoginBtn.addEventListener("click",v)}async function p(o){o.preventDefault();const t=e.emailInput.value.trim(),n=e.passwordInput.value;if(!t||!n){s("Por favor, preencha todos os campos");return}if(!E(t)){s("Por favor, insira um e-mail válido");return}await y(t,n)}async function y(o,t){l(!0),d();try{const n=await g.collection("users").authWithPassword(o,t);i.isDevelopment&&console.log("[Login] Login bem-sucedido:",n.record.email),h("Login realizado com sucesso! Redirecionando..."),setTimeout(()=>{c()},1e3)}catch(n){console.error("[Login] Erro ao fazer login:",n),n.status===400?s("E-mail ou senha incorretos"):n.status===0?s("Erro de conexão. Verifique sua internet"):s("Erro ao realizar login. Tente novamente"),l(!1)}}function l(o){e.loginBtn.disabled=o,e.emailInput.disabled=o,e.passwordInput.disabled=o,o?e.loginBtn.textContent="Entrando...":e.loginBtn.textContent="Entrar"}function s(o){e.errorMsg.textContent=o,e.errorMsg.style.display="block",e.successMsg.style.display="none"}function h(o){e.successMsg.textContent=o,e.successMsg.style.display="block",e.errorMsg.style.display="none"}function d(){e.errorMsg.style.display="none",e.successMsg.style.display="none"}function E(o){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)}function v(o){o.preventDefault(),d(),i.isDevelopment&&console.log("[Login] Iniciando login com Google OAuth..."),r.loginWithGoogle()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();
