import{p as t,A as o,C as a,b as n}from"./auth.js";class i{static async checkRefreshToken(){try{return(await t.send(o.checkRefreshToken,{method:"GET"})).hasRefreshToken}catch(e){return console.error("[SheetsService] Erro ao verificar refresh token:",e),!1}}static async listGoogleSheets(){try{return(await t.send(o.listGoogleSheets,{method:"GET"})).sheets||[]}catch(e){throw console.error("[SheetsService] Erro ao listar planilhas:",e),e}}static async saveSheetId(e,r){try{await t.send(o.saveSheetId,{method:"POST",body:{sheet_id:e,sheet_name:r}})}catch(s){throw console.error("[SheetsService] Erro ao salvar sheet ID:",s),s}}static async provisionSheet(){try{return await t.send(o.provisionSheet,{method:"POST"})}catch(e){throw console.error("[SheetsService] Erro ao provisionar planilha:",e),e}}static async getCurrentSheet(){try{return await t.send(o.getCurrentSheet,{method:"GET"})}catch(e){return console.error("[SheetsService] Erro ao obter planilha atual:",e),{}}}static async getConfigStatus(){try{return await t.send(o.configStatus,{method:"GET"})}catch(e){return console.error("[SheetsService] Erro ao obter status:",e),{hasRefreshToken:!1,hasSheetId:!1}}}static async appendEntry(e){try{await t.send(o.appendEntry,{method:"POST",body:e}),console.log("[SheetsService] Invalidando caches após adicionar lançamento"),a.clear(n.SHEET_ENTRIES),a.clear(n.SHEET_CATEGORIES)}catch(r){throw console.error("[SheetsService] Erro ao adicionar lançamento:",r),r}}static async editEntry(e,r){try{await t.send(o.editSheetEntry,{method:"PUT",body:{rowIndex:e,...r}}),console.log("[SheetsService] Invalidando caches após editar lançamento"),a.clear(n.SHEET_ENTRIES),a.clear(n.SHEET_CATEGORIES)}catch(s){throw console.error("[SheetsService] Erro ao editar lançamento:",s),s}}static async deleteEntry(e){try{await t.send(o.deleteSheetEntry,{method:"DELETE",body:{rowIndex:e}}),console.log("[SheetsService] Invalidando caches após deletar lançamento"),a.clear(n.SHEET_ENTRIES),a.clear(n.SHEET_CATEGORIES)}catch(r){throw console.error("[SheetsService] Erro ao deletar lançamento:",r),r}}static async getSheetEntries(e,r){try{return(await t.send(`${o.getSheetEntries}?month=${e}&year=${r}`,{method:"GET"})).entries||[]}catch(s){throw console.error("[SheetsService] Erro ao obter lançamentos:",s),s}}static async getFinancialSummary(e,r){try{return await t.send(`${o.getFinancialSummary}?month=${e}&year=${r}`,{method:"GET"})}catch(s){throw console.error("[SheetsService] Erro ao obter resumo financeiro:",s),s}}static async getAvailableMonths(){try{return(await t.send(o.getAvailableMonths,{method:"GET"})).months||[]}catch(e){return console.error("[SheetsService] Erro ao obter meses disponíveis:",e),[]}}static async getSheetCategories(e=!1){if(!e){const r=a.get(n.SHEET_CATEGORIES);if(r)return console.log("[SheetsService] Usando categorias do cache"),r.categories||[]}try{console.log("[SheetsService] Buscando categorias do servidor");const r=await t.send(o.getSheetCategories,{method:"GET"});return a.set(n.SHEET_CATEGORIES,r),r.categories||[]}catch(r){return console.error("[SheetsService] Erro ao obter categorias:",r),[]}}static async clearSheetContent(){try{await t.send(o.clearSheetContent,{method:"POST"})}catch(e){throw console.error("[SheetsService] Erro ao limpar planilha:",e),e}}static async deleteSheetConfig(){try{await t.send(o.deleteSheetConfig,{method:"POST"})}catch(e){throw console.error("[SheetsService] Erro ao deletar configuração:",e),e}}static async revokeGoogleAccess(){try{await t.send(o.revokeGoogleAccess,{method:"POST"})}catch(e){throw console.error("[SheetsService] Erro ao revogar acesso:",e),e}}static async refreshToken(){try{await t.send(o.googleRefreshToken,{method:"POST"})}catch(e){throw console.error("[SheetsService] Erro ao renovar token:",e),e}}}export{i as S};
