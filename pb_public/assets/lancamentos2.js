var T=Object.defineProperty;var C=(l,t,e)=>t in l?T(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var u=(l,t,e)=>C(l,typeof t!="symbol"?t+"":t,e);import{p as c,c as g,C as v,b as w}from"./auth.js";let p=null;class k{constructor(){u(this,"modal",null);u(this,"form",null);u(this,"callback");u(this,"accounts",[]);u(this,"categories",[]);u(this,"descriptions",[]);u(this,"entries",[])}getTemplate(){return`
      <div id="entryModal" class="entry-modal" aria-hidden="true" style="display: none;">
        <div class="entry-modal__content">
          <button id="closeEntryModal" class="entry-modal__close" aria-label="Fechar modal">√ó</button>
          <h3 class="entry-modal__title">Lan√ßamento de Despesa/Receita</h3>
          <form id="expenseForm" class="entry-modal__form">
            <fieldset>
              <div class="form-group">
                <label for="expenseDate">Data:</label>
                <input type="datetime-local" id="expenseDate" name="data" class="form-control" required>
              </div>
              
              <div class="form-group">
                <label for="expenseAccount">Conta:</label>
                <input type="text" id="expenseAccount" name="conta" class="form-control" placeholder="Ex: Conta Corrente" autocomplete="off" required>
              </div>
              
              <div class="form-group valor-toggle-group">
                <label for="expenseValue">Valor:</label>
                <div class="valor-toggle-container">
                  <button type="button" id="expenseSignBtn" class="button outline entry-toggle entry-toggle--expense" aria-label="Alternar sinal">‚àí</button>
                  <input type="number" id="expenseValue" name="valor" class="form-control" step="0.01" min="0" placeholder="0,00" required>
                  <input type="hidden" id="expenseSignValue" name="sinal" value="‚àí">
                </div>
              </div>
              
              <div class="form-group">
                <label for="expenseDescription">Descri√ß√£o:</label>
                <input type="text" id="expenseDescription" name="descricao" class="form-control" placeholder="Descri√ß√£o da despesa" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="expenseCategory">Categoria:</label>
                <input type="text" id="expenseCategory" name="categoria" class="form-control" placeholder="Digite uma categoria" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="expenseBudget">Or√ßamento (data-chave):</label>
                <input type="date" id="expenseBudget" name="orcamento" class="form-control" required>
              </div>
              
              <div id="modalFeedback" class="modal-feedback" style="display: none;"></div>
              
              <div class="form-actions">
                <button type="reset" class="button warning">Limpar</button>
                <button type="submit" class="button success">Salvar</button>
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    `}async init(t){if(console.log("[EntryModal] Inicializando..."),this.callback=t,document.body.insertAdjacentHTML("beforeend",this.getTemplate()),this.modal=document.getElementById("entryModal"),this.form=document.getElementById("expenseForm"),!this.modal||!this.form)throw new Error("[EntryModal] Elementos do modal n√£o encontrados");this.setupEventListeners(),this.setSignState(!0),await this.loadAutocompleteData(),console.log("[EntryModal] ‚úÖ Inicializado com sucesso")}setupEventListeners(){var o,a,s;const t=document.getElementById("closeEntryModal");t==null||t.addEventListener("click",()=>this.close()),(o=this.modal)==null||o.addEventListener("click",n=>{n.target===this.modal&&this.close()}),document.addEventListener("keydown",n=>{var r;n.key==="Escape"&&((r=this.modal)==null?void 0:r.style.display)==="flex"&&this.close()});const e=document.getElementById("expenseSignBtn");e==null||e.addEventListener("click",()=>this.toggleSign()),(a=this.form)==null||a.addEventListener("submit",n=>this.handleSubmit(n)),(s=this.form)==null||s.addEventListener("reset",()=>{setTimeout(()=>this.setSignState(!0),0)}),this.setupCategoryAutocomplete(),this.setupDescriptionAutocomplete(),this.setupAccountAutocomplete()}setupCategoryAutocomplete(){const t=document.getElementById("expenseCategory");if(!t)return;let e=this.ensureSuggestionsContainer("catSuggestions",t);t.addEventListener("focus",()=>{this.categories.length>0&&this.showAllSuggestions(t,e,this.categories)}),t.addEventListener("input",()=>{this.showSuggestions(t,e,this.categories)}),t.addEventListener("blur",()=>{setTimeout(()=>e.style.display="none",200)})}setupDescriptionAutocomplete(){const t=document.getElementById("expenseDescription");if(!t)return;let e=this.ensureSuggestionsContainer("descSuggestions",t);t.addEventListener("focus",()=>{this.descriptions.length>0&&(t.value.trim().toLowerCase()||this.showAllSuggestions(t,e,this.descriptions,a=>{this.autoFillCategoryFromDescription(a)}))}),t.addEventListener("input",()=>{this.showSuggestions(t,e,this.descriptions,o=>{this.autoFillCategoryFromDescription(o)})}),t.addEventListener("blur",()=>{setTimeout(()=>e.style.display="none",200)})}autoFillCategoryFromDescription(t){const e=this.entries.find(o=>o.descricao&&o.descricao.trim().toLowerCase()===t.toLowerCase());if(e&&e.categoria){const o=document.getElementById("expenseCategory");o&&(o.value=e.categoria)}}setupAccountAutocomplete(){const t=document.getElementById("expenseAccount");if(!t)return;let e=this.ensureSuggestionsContainer("accountSuggestions",t);t.addEventListener("focus",()=>{this.accounts.length>0&&(t.value.trim().toLowerCase()||this.showAllSuggestions(t,e,this.accounts))}),t.addEventListener("input",()=>{this.showSuggestions(t,e,this.accounts)}),t.addEventListener("blur",()=>{setTimeout(()=>e.style.display="none",200)})}ensureSuggestionsContainer(t,e){let o=document.getElementById(t);if(!o){o=document.createElement("div"),o.id=t,o.classList.add("entry-modal__suggestions"),o.setAttribute("role","listbox");const a=e.parentElement;a&&(a.style.position=a.style.position||"relative",a.appendChild(o))}return o}showAllSuggestions(t,e,o,a){if(e.innerHTML="",o.length===0){e.style.display="none";return}o.slice(0,20).forEach(n=>{const r=document.createElement("div");r.setAttribute("role","option"),r.classList.add("entry-modal__suggestion"),r.textContent=n,r.addEventListener("click",()=>{t.value=n,e.style.display="none",t.focus(),a&&a(n)}),e.appendChild(r)}),e.style.display="block"}showSuggestions(t,e,o,a){e.innerHTML="";const s=t.value.trim().toLowerCase();if(!s||s.length<1){this.showAllSuggestions(t,e,o,a);return}if(o.length===0){e.style.display="none";return}const n=o.filter(r=>r.toLowerCase().includes(s));if(n.length===0){e.style.display="none";return}n.forEach(r=>{const i=document.createElement("div");i.setAttribute("role","option"),i.classList.add("entry-modal__suggestion"),i.textContent=r,i.addEventListener("click",()=>{t.value=r,e.style.display="none",t.focus(),a&&a(r)}),e.appendChild(i)}),e.style.display="block"}async loadAutocompleteData(){console.log("[EntryModal] üì¶ Carregando dados para autocomplete..."),console.log("[EntryModal] Auth token:",c.authStore.token?"Presente":"Ausente");try{const t=`${g.pocketbaseUrl}/get-sheet-entries?limit=0`;console.log("[EntryModal] Buscando entries de:",t);const e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""}});if(e.ok){const s=await e.json();this.entries=(s==null?void 0:s.entries)??[],console.log("[EntryModal] Entries recebidos:",this.entries.length),this.accounts=[...new Set(this.entries.map(n=>n.conta).filter(n=>n&&n.trim()))].sort(),console.log("[EntryModal] Contas extra√≠das:",this.accounts),this.descriptions=[...new Set(this.entries.map(n=>n.descricao).filter(n=>n&&n.trim()))].sort(),console.log("[EntryModal] Descri√ß√µes extra√≠das:",this.descriptions.length)}else{console.warn("[EntryModal] ‚ö†Ô∏è Erro ao buscar entries:",e.status,e.statusText);const s=await e.text();console.warn("[EntryModal] Resposta:",s)}const o=`${g.pocketbaseUrl}/get-sheet-categories`;console.log("[EntryModal] Buscando categorias de:",o);const a=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""}});if(a.ok){const s=await a.json();this.categories=s!=null&&s.success&&Array.isArray(s.categories)?s.categories:[],console.log("[EntryModal] Categorias recebidas:",this.categories)}else{console.warn("[EntryModal] ‚ö†Ô∏è Erro ao buscar categorias:",a.status,a.statusText);const s=await a.text();console.warn("[EntryModal] Resposta:",s)}console.log("[EntryModal] ‚úÖ Dados carregados:",{accounts:this.accounts.length,categories:this.categories.length,descriptions:this.descriptions.length})}catch(t){console.error("[EntryModal] ‚ö†Ô∏è Erro ao carregar dados:",t)}}toggleSign(){var o;const t=document.getElementById("expenseSignBtn"),e=((o=t==null?void 0:t.textContent)==null?void 0:o.trim())==="‚àí";this.setSignState(!e)}formatDateTimeLocal(t){const[e,o]=t.split("T"),[a,s,n]=e.split("-");return`${n}/${s}/${a} ${o}`}formatDate(t){const[e,o,a]=t.split("-");return`${a}/${o}/${e}`}setSignState(t){const e=document.getElementById("expenseSignBtn"),o=document.getElementById("expenseSignValue");!e||!o||(t?(e.textContent="‚àí",e.classList.add("entry-toggle--expense"),e.classList.remove("entry-toggle--income"),o.value="‚àí"):(e.textContent="+",e.classList.remove("entry-toggle--expense"),e.classList.add("entry-toggle--income"),o.value="+"))}async handleSubmit(t){var f;if(t.preventDefault(),!this.form)return;const e=new FormData(this.form),o=e.get("data"),a=e.get("orcamento"),s=e.get("valor"),n=this.formatDateTimeLocal(o),r=this.formatDate(a),i={data:n,conta:e.get("conta"),valor:parseFloat(s),descricao:e.get("descricao"),categoria:e.get("categoria"),orcamento:r},d=(f=document.getElementById("expenseSignValue"))==null?void 0:f.value,m=d==="‚àí"||d==="-"?-1:1;i.valor=m*Math.abs(i.valor),await this.submitEntry(i)}async submitEntry(t){var e;this.showFeedback("Enviando...","info"),this.setFormDisabled(!0);try{const o={data:t.data,conta:t.conta,valor:t.valor,descricao:t.descricao,categoria:t.categoria,orcamento:t.orcamento};console.log("[EntryModal] üì§ Enviando:",o);const a=await fetch(`${g.pocketbaseUrl}/append-entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""},body:JSON.stringify(o)}),s=await a.json();if(!a.ok)throw new Error(s.message||"Erro ao adicionar lan√ßamento");console.log("[EntryModal] ‚úÖ Sucesso:",s),this.showFeedback("‚úÖ Lan√ßamento adicionado com sucesso!","success"),(e=this.form)==null||e.reset(),this.setSignState(!0),this.callback&&this.callback(s),setTimeout(()=>this.close(),1500)}catch(o){console.error("[EntryModal] ‚ùå Erro:",o),this.showFeedback(`‚ùå Erro: ${o instanceof Error?o.message:"Erro desconhecido"}`,"error")}finally{this.setFormDisabled(!1)}}showFeedback(t,e){const o=document.getElementById("modalFeedback");o&&(o.textContent=t,o.className=`modal-feedback modal-feedback--${e}`,o.style.display="block",(e==="success"||e==="error")&&setTimeout(()=>{o.style.display="none"},5e3))}setFormDisabled(t){if(!this.form)return;this.form.querySelectorAll("input, button, select, textarea").forEach(o=>{o.disabled=t})}open(){var o;if(!this.modal)return;console.log("[EntryModal] Modal aberto"),this.modal.style.display="flex",this.modal.setAttribute("aria-hidden","false");const t=document.getElementById("openEntryModal");t?(t.classList.add("modal-open"),console.log("[EntryModal] ‚úÖ Classe modal-open adicionada ao bot√£o FAB")):console.warn("[EntryModal] ‚ö†Ô∏è Bot√£o FAB n√£o encontrado"),this.fillCurrentDateTime(),this.fillNextBudget();const e=(o=this.form)==null?void 0:o.querySelector("input");e==null||e.focus(),this.setSignState(!0)}close(){if(!this.modal)return;console.log("[EntryModal] Modal fechado"),this.modal.style.display="none",this.modal.setAttribute("aria-hidden","true");const t=document.getElementById("openEntryModal");t?(t.classList.remove("modal-open"),console.log("[EntryModal] ‚úÖ Classe modal-open removida do bot√£o FAB")):console.warn("[EntryModal] ‚ö†Ô∏è Bot√£o FAB n√£o encontrado");const e=document.getElementById("modalFeedback");e&&(e.style.display="none")}fillCurrentDateTime(){const t=document.getElementById("expenseDate");if(!t)return;const e=new Date,o=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");t.value=`${o}-${a}-${s}T${n}:${r}`}fillNextBudget(){const t=document.getElementById("expenseBudget");if(!t)return;const e=[...new Set(this.entries.map(n=>n.orcamento).filter(n=>n!=null&&!isNaN(Number(n))).map(n=>Number(n)))].sort((n,r)=>n-r);if(e.length===0){const n=new Date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0");t.value=`${r}-${i}-01`;return}const a=Math.floor((new Date().getTime()-new Date(1899,11,31).getTime())/864e5)+1,s=e.find(n=>n>=a);if(s){const n=new Date(1899,11,31);n.setDate(n.getDate()+s-1);const r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0");t.value=`${r}-${i}-${d}`}else{const n=e[e.length-1],r=new Date(1899,11,31);r.setDate(r.getDate()+n-1);const i=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),m=String(r.getDate()).padStart(2,"0");t.value=`${i}-${d}-${m}`}}}async function I(l){return p?(console.warn("[EntryModal] Modal j√° inicializado"),p):(p=new k,await p.init(l),p)}function _(){if(!p){console.error("[EntryModal] Modal n√£o inicializado. Chame initEntryModal() primeiro.");return}p.open()}let h=null;class B{constructor(){u(this,"modal",null);u(this,"form",null);u(this,"callback");u(this,"categories",[]);u(this,"descriptions",[]);u(this,"entries",[])}getTemplate(){return`
      <div id="futureEntryModal" class="entry-modal" aria-hidden="true" style="display: none;">
        <div class="entry-modal__content">
          <button id="closeFutureEntryModal" class="entry-modal__close" aria-label="Fechar modal">√ó</button>
          <h3 class="entry-modal__title">Lan√ßamento Futuro</h3>
          <form id="futureExpenseForm" class="entry-modal__form">
            <fieldset>
              <div class="form-group valor-toggle-group">
                <label for="futureExpenseValue">Valor:</label>
                <div class="valor-toggle-container">
                  <button type="button" id="futureExpenseSignBtn" class="button outline entry-toggle entry-toggle--expense" aria-label="Alternar sinal">‚àí</button>
                  <input type="number" id="futureExpenseValue" name="valor" class="form-control" step="0.01" min="0" placeholder="0,00" required>
                  <input type="hidden" id="futureExpenseSignValue" name="sinal" value="‚àí">
                </div>
              </div>
              
              <div class="form-group">
                <label for="futureExpenseDescription">Descri√ß√£o:</label>
                <input type="text" id="futureExpenseDescription" name="descricao" class="form-control" placeholder="Descri√ß√£o do lan√ßamento" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="futureExpenseCategory">Categoria:</label>
                <input type="text" id="futureExpenseCategory" name="categoria" class="form-control" placeholder="Digite uma categoria" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="futureExpenseBudget">Or√ßamento (data-chave):</label>
                <input type="date" id="futureExpenseBudget" name="orcamento" class="form-control" required>
              </div>
              
              <div id="futureModalFeedback" class="modal-feedback" style="display: none;"></div>
              
              <div class="form-actions">
                <button type="reset" class="button warning">Limpar</button>
                <button type="submit" class="button success">Salvar</button>
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    `}async init(t){if(console.log("[FutureEntryModal] Inicializando..."),this.callback=t,document.body.insertAdjacentHTML("beforeend",this.getTemplate()),this.modal=document.getElementById("futureEntryModal"),this.form=document.getElementById("futureExpenseForm"),!this.modal||!this.form)throw new Error("[FutureEntryModal] Elementos do modal n√£o encontrados");this.setupEventListeners(),this.setSignState(!0),await this.loadAutocompleteData(),console.log("[FutureEntryModal] ‚úÖ Inicializado com sucesso")}setupEventListeners(){var o,a,s;const t=document.getElementById("closeFutureEntryModal");t==null||t.addEventListener("click",()=>this.close()),(o=this.modal)==null||o.addEventListener("click",n=>{n.target===this.modal&&this.close()}),document.addEventListener("keydown",n=>{var r;n.key==="Escape"&&((r=this.modal)==null?void 0:r.style.display)==="flex"&&this.close()});const e=document.getElementById("futureExpenseSignBtn");e==null||e.addEventListener("click",()=>this.toggleSign()),(a=this.form)==null||a.addEventListener("submit",n=>this.handleSubmit(n)),(s=this.form)==null||s.addEventListener("reset",()=>{setTimeout(()=>this.setSignState(!0),0)}),this.setupCategoryAutocomplete(),this.setupDescriptionAutocomplete()}setupCategoryAutocomplete(){const t=document.getElementById("futureExpenseCategory");if(!t)return;let e=this.ensureSuggestionsContainer("futureCatSuggestions",t);t.addEventListener("focus",()=>{this.categories.length>0&&this.showAllSuggestions(t,e,this.categories)}),t.addEventListener("input",()=>{this.showSuggestions(t,e,this.categories)}),t.addEventListener("blur",()=>{setTimeout(()=>e.style.display="none",200)})}setupDescriptionAutocomplete(){const t=document.getElementById("futureExpenseDescription");if(!t)return;let e=this.ensureSuggestionsContainer("futureDescSuggestions",t);t.addEventListener("focus",()=>{this.descriptions.length>0&&(t.value.trim().toLowerCase()||this.showAllSuggestions(t,e,this.descriptions,a=>{this.autoFillCategoryFromDescription(a)}))}),t.addEventListener("input",()=>{this.showSuggestions(t,e,this.descriptions,o=>{this.autoFillCategoryFromDescription(o)})}),t.addEventListener("blur",()=>{setTimeout(()=>e.style.display="none",200)})}autoFillCategoryFromDescription(t){const e=this.entries.find(o=>o.descricao&&o.descricao.trim().toLowerCase()===t.toLowerCase());if(e&&e.categoria){const o=document.getElementById("futureExpenseCategory");o&&(o.value=e.categoria)}}ensureSuggestionsContainer(t,e){let o=document.getElementById(t);if(!o){o=document.createElement("div"),o.id=t,o.classList.add("entry-modal__suggestions"),o.setAttribute("role","listbox");const a=e.parentElement;a&&(a.style.position=a.style.position||"relative",a.appendChild(o))}return o}showAllSuggestions(t,e,o,a){if(e.innerHTML="",o.length===0){e.style.display="none";return}o.slice(0,20).forEach(n=>{const r=document.createElement("div");r.setAttribute("role","option"),r.classList.add("entry-modal__suggestion"),r.textContent=n,r.addEventListener("click",()=>{t.value=n,e.style.display="none",t.focus(),a&&a(n)}),e.appendChild(r)}),e.style.display="block"}showSuggestions(t,e,o,a){e.innerHTML="";const s=t.value.trim().toLowerCase();if(!s||s.length<1){this.showAllSuggestions(t,e,o,a);return}if(o.length===0){e.style.display="none";return}const n=o.filter(r=>r.toLowerCase().includes(s));if(n.length===0){e.style.display="none";return}n.forEach(r=>{const i=document.createElement("div");i.setAttribute("role","option"),i.classList.add("entry-modal__suggestion"),i.textContent=r,i.addEventListener("click",()=>{t.value=r,e.style.display="none",t.focus(),a&&a(r)}),e.appendChild(i)}),e.style.display="block"}async loadAutocompleteData(){console.log("[FutureEntryModal] üì¶ Carregando dados para autocomplete...");try{const t=`${g.pocketbaseUrl}/get-sheet-entries?limit=0`,e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""}});if(e.ok){const s=await e.json();this.entries=(s==null?void 0:s.entries)??[],this.descriptions=[...new Set(this.entries.map(n=>n.descricao).filter(n=>n&&n.trim()))].sort()}const o=`${g.pocketbaseUrl}/get-sheet-categories`,a=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""}});if(a.ok){const s=await a.json();this.categories=s!=null&&s.success&&Array.isArray(s.categories)?s.categories:[]}console.log("[FutureEntryModal] ‚úÖ Dados carregados")}catch(t){console.error("[FutureEntryModal] ‚ö†Ô∏è Erro ao carregar dados:",t)}}toggleSign(){var o;const t=document.getElementById("futureExpenseSignBtn"),e=((o=t==null?void 0:t.textContent)==null?void 0:o.trim())==="‚àí";this.setSignState(!e)}formatDate(t){const[e,o,a]=t.split("-");return`${a}/${o}/${e}`}setSignState(t){const e=document.getElementById("futureExpenseSignBtn"),o=document.getElementById("futureExpenseSignValue");!e||!o||(t?(e.textContent="‚àí",e.classList.add("entry-toggle--expense"),e.classList.remove("entry-toggle--income"),o.value="‚àí"):(e.textContent="+",e.classList.remove("entry-toggle--expense"),e.classList.add("entry-toggle--income"),o.value="+"))}async handleSubmit(t){var e;if(t.preventDefault(),!!this.form)try{const o=new FormData(this.form),a=o.get("orcamento"),s=o.get("valor"),n=o.get("descricao"),r=o.get("categoria");if(!a||!s||!n||!r){this.showFeedback("‚ùå Todos os campos s√£o obrigat√≥rios","error");return}const i=parseFloat(s);if(isNaN(i)||i<=0){this.showFeedback("‚ùå Valor inv√°lido","error");return}const d=this.formatDate(a),m={valor:i,descricao:n,categoria:r,orcamento:d},f=(e=document.getElementById("futureExpenseSignValue"))==null?void 0:e.value,S=f==="‚àí"||f==="-"?-1:1;m.valor=S*Math.abs(m.valor),await this.submitEntry(m)}catch(o){console.error("[FutureEntryModal] ‚ùå Erro no handleSubmit:",o),this.showFeedback(`‚ùå Erro ao processar formul√°rio: ${o instanceof Error?o.message:"Erro desconhecido"}`,"error")}}async submitEntry(t){var e;this.showFeedback("Enviando...","info"),this.setFormDisabled(!0);try{const o={data:"",conta:"",valor:t.valor,descricao:t.descricao,categoria:t.categoria,orcamento:t.orcamento};console.log("[FutureEntryModal] üì§ Enviando:",o),console.log("[FutureEntryModal] üìç URL:",`${g.pocketbaseUrl}/append-entry`),console.log("[FutureEntryModal] üîë Token presente:",!!c.authStore.token);const a=await fetch(`${g.pocketbaseUrl}/append-entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""},body:JSON.stringify(o)});console.log("[FutureEntryModal] üì° Response status:",a.status);const s=await a.json();if(console.log("[FutureEntryModal] üì¶ Response data:",s),!a.ok)throw new Error(s.message||"Erro ao adicionar lan√ßamento futuro");console.log("[FutureEntryModal] ‚úÖ Sucesso:",s),this.showFeedback("‚úÖ Lan√ßamento futuro adicionado com sucesso!","success"),(e=this.form)==null||e.reset(),this.setSignState(!0),this.callback&&this.callback(s),setTimeout(()=>this.close(),1500)}catch(o){console.error("[FutureEntryModal] ‚ùå Erro completo:",o),console.error("[FutureEntryModal] ‚ùå Stack trace:",o instanceof Error?o.stack:"N/A"),this.showFeedback(`‚ùå Erro: ${o instanceof Error?o.message:"Erro desconhecido"}`,"error")}finally{this.setFormDisabled(!1)}}showFeedback(t,e){const o=document.getElementById("futureModalFeedback");o&&(o.textContent=t,o.className=`modal-feedback modal-feedback--${e}`,o.style.display="block",(e==="success"||e==="error")&&setTimeout(()=>{o.style.display="none"},5e3))}setFormDisabled(t){if(!this.form)return;this.form.querySelectorAll("input, button, select, textarea").forEach(o=>{o.disabled=t})}open(){var o;if(!this.modal)return;console.log("[FutureEntryModal] Modal aberto"),this.modal.style.display="flex",this.modal.setAttribute("aria-hidden","false");const t=document.getElementById("openEntryModal");t&&(t.classList.add("modal-open"),console.log("[FutureEntryModal] ‚úÖ Classe modal-open adicionada ao bot√£o FAB")),this.fillNextBudget();const e=(o=this.form)==null?void 0:o.querySelector('input[type="number"]');e==null||e.focus(),this.setSignState(!0)}close(){if(!this.modal)return;console.log("[FutureEntryModal] Modal fechado"),this.modal.style.display="none",this.modal.setAttribute("aria-hidden","true");const t=document.getElementById("openEntryModal");t&&(t.classList.remove("modal-open"),console.log("[FutureEntryModal] ‚úÖ Classe modal-open removida do bot√£o FAB"));const e=document.getElementById("futureModalFeedback");e&&(e.style.display="none")}fillNextBudget(){const t=document.getElementById("futureExpenseBudget");if(!t)return;const e=[...new Set(this.entries.map(n=>n.orcamento).filter(n=>n!=null&&!isNaN(Number(n))).map(n=>Number(n)))].sort((n,r)=>n-r);if(e.length===0){const n=new Date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0");t.value=`${r}-${i}-01`;return}const a=Math.floor((new Date().getTime()-new Date(1899,11,31).getTime())/864e5)+1,s=e.find(n=>n>=a);if(s){const n=new Date(1899,11,31);n.setDate(n.getDate()+s-1);const r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0");t.value=`${r}-${i}-${d}`}else{const n=e[e.length-1],r=new Date(1899,11,31);r.setDate(r.getDate()+n-1);const i=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),m=String(r.getDate()).padStart(2,"0");t.value=`${i}-${d}-${m}`}}}async function N(l){return h?(console.warn("[FutureEntryModal] Modal j√° inicializado"),h):(h=new B,await h.init(l),h)}function j(){if(!h){console.error("[FutureEntryModal] Modal n√£o inicializado. Chame initFutureEntryModal() primeiro.");return}h.open()}let y=null;class F{constructor(){u(this,"modal",null);u(this,"form",null);u(this,"callback");u(this,"accounts",[]);u(this,"entries",[])}getTemplate(){return`
      <div id="transferEntryModal" class="entry-modal" aria-hidden="true" style="display: none;">
        <div class="entry-modal__content">
          <button id="closeTransferEntryModal" class="entry-modal__close" aria-label="Fechar modal">√ó</button>
          <h3 class="entry-modal__title">Transfer√™ncia entre Contas</h3>
          <form id="transferForm" class="entry-modal__form">
            <fieldset>
              <div class="form-group">
                <label for="transferDate">Data:</label>
                <input type="datetime-local" id="transferDate" name="data" class="form-control" required>
              </div>
              
              <div class="form-group">
                <label for="transferValue">Valor:</label>
                <input type="number" id="transferValue" name="valor" class="form-control" step="0.01" min="0.01" placeholder="0,00" required>
              </div>
              
              <div class="form-group">
                <label for="transferAccountOut">Conta Sa√≠da:</label>
                <input type="text" id="transferAccountOut" name="contaSaida" class="form-control" placeholder="Ex: Conta Corrente" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="transferAccountIn">Conta Entrada:</label>
                <input type="text" id="transferAccountIn" name="contaEntrada" class="form-control" placeholder="Ex: Poupan√ßa" autocomplete="off" required>
              </div>
              
              <div class="form-group">
                <label for="transferBudget">Or√ßamento (data-chave):</label>
                <input type="date" id="transferBudget" name="orcamento" class="form-control" required>
              </div>
              
              <div id="transferModalFeedback" class="modal-feedback" style="display: none;"></div>
              
              <div class="form-actions">
                <button type="reset" class="button warning">Limpar</button>
                <button type="submit" class="button success">Transferir</button>
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    `}async init(t){if(console.log("[TransferEntryModal] Inicializando..."),this.callback=t,document.body.insertAdjacentHTML("beforeend",this.getTemplate()),this.modal=document.getElementById("transferEntryModal"),this.form=document.getElementById("transferForm"),!this.modal||!this.form)throw new Error("[TransferEntryModal] Elementos do modal n√£o encontrados");this.setupEventListeners(),await this.loadAutocompleteData(),console.log("[TransferEntryModal] ‚úÖ Inicializado com sucesso")}setupEventListeners(){var e,o;const t=document.getElementById("closeTransferEntryModal");t==null||t.addEventListener("click",()=>this.close()),(e=this.modal)==null||e.addEventListener("click",a=>{a.target===this.modal&&this.close()}),document.addEventListener("keydown",a=>{var s;a.key==="Escape"&&((s=this.modal)==null?void 0:s.style.display)==="flex"&&this.close()}),(o=this.form)==null||o.addEventListener("submit",a=>this.handleSubmit(a)),this.setupAccountAutocomplete("transferAccountOut"),this.setupAccountAutocomplete("transferAccountIn")}setupAccountAutocomplete(t){const e=document.getElementById(t);if(!e)return;const o=`${t}Suggestions`;let a=this.ensureSuggestionsContainer(o,e);e.addEventListener("focus",()=>{this.accounts.length>0&&(e.value.trim().toLowerCase()||this.showAllSuggestions(e,a,this.accounts))}),e.addEventListener("input",()=>{this.showSuggestions(e,a,this.accounts)}),e.addEventListener("blur",()=>{setTimeout(()=>a.style.display="none",200)})}ensureSuggestionsContainer(t,e){let o=document.getElementById(t);if(!o){o=document.createElement("div"),o.id=t,o.classList.add("entry-modal__suggestions"),o.setAttribute("role","listbox");const a=e.parentElement;a&&(a.style.position=a.style.position||"relative",a.appendChild(o))}return o}showAllSuggestions(t,e,o){if(e.innerHTML="",o.length===0){e.style.display="none";return}o.slice(0,20).forEach(s=>{const n=document.createElement("div");n.setAttribute("role","option"),n.classList.add("entry-modal__suggestion"),n.textContent=s,n.addEventListener("click",()=>{t.value=s,e.style.display="none",t.focus()}),e.appendChild(n)}),e.style.display="block"}showSuggestions(t,e,o){e.innerHTML="";const a=t.value.trim().toLowerCase();if(!a||a.length<1){this.showAllSuggestions(t,e,o);return}if(o.length===0){e.style.display="none";return}const s=o.filter(n=>n.toLowerCase().includes(a));if(s.length===0){e.style.display="none";return}s.forEach(n=>{const r=document.createElement("div");r.setAttribute("role","option"),r.classList.add("entry-modal__suggestion"),r.textContent=n,r.addEventListener("click",()=>{t.value=n,e.style.display="none",t.focus()}),e.appendChild(r)}),e.style.display="block"}async loadAutocompleteData(){console.log("[TransferEntryModal] üì¶ Carregando dados para autocomplete...");try{const t=`${g.pocketbaseUrl}/get-sheet-entries?limit=0`,e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""}});if(e.ok){const o=await e.json();this.entries=(o==null?void 0:o.entries)??[],this.accounts=[...new Set(this.entries.map(a=>a.conta).filter(a=>a&&a.trim()))].sort()}console.log("[TransferEntryModal] ‚úÖ Dados carregados")}catch(t){console.error("[TransferEntryModal] ‚ö†Ô∏è Erro ao carregar dados:",t)}}formatDateTimeLocal(t){const[e,o]=t.split("T"),[a,s,n]=e.split("-");return`${n}/${s}/${a} ${o}`}formatDate(t){const[e,o,a]=t.split("-");return`${a}/${o}/${e}`}async handleSubmit(t){if(t.preventDefault(),!this.form)return;const e=new FormData(this.form),o=e.get("data"),a=e.get("orcamento"),s=e.get("valor"),n=this.formatDateTimeLocal(o),r=this.formatDate(a),i={data:n,valor:parseFloat(s),contaSaida:e.get("contaSaida"),contaEntrada:e.get("contaEntrada"),orcamento:r};await this.submitTransfer(i)}async submitTransfer(t){var e;this.showFeedback("Enviando...","info"),this.setFormDisabled(!0);try{const o={data:t.data,conta:t.contaSaida,valor:-Math.abs(t.valor),descricao:`Transfer√™ncia para ${t.contaEntrada}`,categoria:"Transfer√™ncia",orcamento:t.orcamento};console.log("[TransferEntryModal] üì§ Enviando sa√≠da:",o);const a=await fetch(`${g.pocketbaseUrl}/append-entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""},body:JSON.stringify(o)}),s=await a.json();if(!a.ok)throw new Error(s.message||"Erro ao adicionar lan√ßamento de sa√≠da");const n={data:t.data,conta:t.contaEntrada,valor:Math.abs(t.valor),descricao:`Transfer√™ncia de ${t.contaSaida}`,categoria:"Transfer√™ncia",orcamento:t.orcamento};console.log("[TransferEntryModal] üì§ Enviando entrada:",n);const r=await fetch(`${g.pocketbaseUrl}/append-entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c.authStore.token?`Bearer ${c.authStore.token}`:""},body:JSON.stringify(n)}),i=await r.json();if(!r.ok)throw new Error(i.message||"Erro ao adicionar lan√ßamento de entrada");console.log("[TransferEntryModal] ‚úÖ Sucesso:",{saida:s,entrada:i}),this.showFeedback("‚úÖ Transfer√™ncia realizada com sucesso!","success"),(e=this.form)==null||e.reset(),this.callback&&this.callback({saida:s,entrada:i}),setTimeout(()=>this.close(),1500)}catch(o){console.error("[TransferEntryModal] ‚ùå Erro:",o),this.showFeedback(`‚ùå Erro: ${o instanceof Error?o.message:"Erro desconhecido"}`,"error")}finally{this.setFormDisabled(!1)}}showFeedback(t,e){const o=document.getElementById("transferModalFeedback");o&&(o.textContent=t,o.className=`modal-feedback modal-feedback--${e}`,o.style.display="block",(e==="success"||e==="error")&&setTimeout(()=>{o.style.display="none"},5e3))}setFormDisabled(t){if(!this.form)return;this.form.querySelectorAll("input, button, select, textarea").forEach(o=>{o.disabled=t})}open(){var o;if(!this.modal)return;console.log("[TransferEntryModal] Modal aberto"),this.modal.style.display="flex",this.modal.setAttribute("aria-hidden","false");const t=document.getElementById("openEntryModal");t&&(t.classList.add("modal-open"),console.log("[TransferEntryModal] ‚úÖ Classe modal-open adicionada ao bot√£o FAB")),this.fillCurrentDateTime(),this.fillNextBudget();const e=(o=this.form)==null?void 0:o.querySelector("input");e==null||e.focus()}close(){if(!this.modal)return;console.log("[TransferEntryModal] Modal fechado"),this.modal.style.display="none",this.modal.setAttribute("aria-hidden","true");const t=document.getElementById("openEntryModal");t&&(t.classList.remove("modal-open"),console.log("[TransferEntryModal] ‚úÖ Classe modal-open removida do bot√£o FAB"));const e=document.getElementById("transferModalFeedback");e&&(e.style.display="none")}fillCurrentDateTime(){const t=document.getElementById("transferDate");if(!t)return;const e=new Date,o=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");t.value=`${o}-${a}-${s}T${n}:${r}`}fillNextBudget(){const t=document.getElementById("transferBudget");if(!t)return;const e=[...new Set(this.entries.map(n=>n.orcamento).filter(n=>n!=null&&!isNaN(Number(n))).map(n=>Number(n)))].sort((n,r)=>n-r);if(e.length===0){const n=new Date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0");t.value=`${r}-${i}-01`;return}const a=Math.floor((new Date().getTime()-new Date(1899,11,31).getTime())/864e5)+1,s=e.find(n=>n>=a);if(s){const n=new Date(1899,11,31);n.setDate(n.getDate()+s-1);const r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0");t.value=`${r}-${i}-${d}`}else{const n=e[e.length-1],r=new Date(1899,11,31);r.setDate(r.getDate()+n-1);const i=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),m=String(r.getDate()).padStart(2,"0");t.value=`${i}-${d}-${m}`}}}async function U(l){return y?(console.warn("[TransferEntryModal] Modal j√° inicializado"),y):(y=new F,await y.init(l),y)}function q(){if(!y){console.error("[TransferEntryModal] Modal n√£o inicializado. Chame initTransferEntryModal() primeiro.");return}y.open()}let E=null;class x{constructor(){u(this,"fabButton",null);u(this,"menuContainer",null);u(this,"isExpanded",!1)}getTemplate(){return`
      <div id="fabMenuContainer" class="fab-menu" style="display: none;">
        <button 
          id="fabOptionTransfer" 
          class="fab-menu__option" 
          aria-label="Transfer√™ncia"
          title="Transfer√™ncia">
          <span class="fab-menu__icon">‚áÑ</span>
          <span class="fab-menu__label">Transfer√™ncia</span>
        </button>
        
        <button 
          id="fabOptionFuture" 
          class="fab-menu__option" 
          aria-label="Lan√ßamento futuro"
          title="Lan√ßamento futuro">
          <span class="fab-menu__icon">üìÖ</span>
          <span class="fab-menu__label">Lan√ßamento futuro</span>
        </button>
        
        <button 
          id="fabOptionEntry" 
          class="fab-menu__option" 
          aria-label="Receita/despesa"
          title="Receita/despesa">
          <span class="fab-menu__icon">üí≤</span>
          <span class="fab-menu__label">Receita/despesa</span>
        </button>
      </div>
    `}init(t,e,o){if(console.log("[FabMenu] Inicializando..."),document.body.insertAdjacentHTML("beforeend",this.getTemplate()),this.menuContainer=document.getElementById("fabMenuContainer"),this.fabButton=document.getElementById("openEntryModal"),!this.menuContainer||!this.fabButton)throw new Error("[FabMenu] Elementos do FAB menu n√£o encontrados");this.fabButton.innerHTML="+",this.setupEventListeners(t,e,o),console.log("[FabMenu] ‚úÖ Inicializado com sucesso")}setupEventListeners(t,e,o){if(!this.fabButton||!this.menuContainer)return;this.fabButton.addEventListener("click",r=>{if(r.stopPropagation(),this.hasOpenModal()){this.closeOpenModals();return}this.toggle()});const a=document.getElementById("fabOptionEntry");a==null||a.addEventListener("click",r=>{r.stopPropagation(),this.collapse(),t()});const s=document.getElementById("fabOptionFuture");s==null||s.addEventListener("click",r=>{r.stopPropagation(),this.collapse(),e()});const n=document.getElementById("fabOptionTransfer");n==null||n.addEventListener("click",r=>{r.stopPropagation(),this.collapse(),o()}),document.addEventListener("click",r=>{var i,d;this.isExpanded&&!((i=this.menuContainer)!=null&&i.contains(r.target))&&!((d=this.fabButton)!=null&&d.contains(r.target))&&this.collapse()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&this.isExpanded&&this.collapse()})}hasOpenModal(){return[document.getElementById("entryModal"),document.getElementById("futureEntryModal"),document.getElementById("transferEntryModal"),document.getElementById("editEntryModal")].some(e=>e&&e.style.display==="flex")}closeOpenModals(){[{id:"entryModal",closeBtn:"closeEntryModal"},{id:"futureEntryModal",closeBtn:"closeFutureEntryModal"},{id:"transferEntryModal",closeBtn:"closeTransferEntryModal"},{id:"editEntryModal",closeBtn:"closeEditEntryModal"}].forEach(({id:e,closeBtn:o})=>{const a=document.getElementById(e);if(a&&a.style.display==="flex"){const s=document.getElementById(o);s&&(s.click(),console.log(`[FabMenu] Modal ${e} fechado`))}})}toggle(){this.isExpanded?this.collapse():this.expand()}expand(){!this.menuContainer||!this.fabButton||(this.isExpanded=!0,this.menuContainer.style.display="flex",this.fabButton.classList.add("fab-button--expanded"),setTimeout(()=>{var t;(t=this.menuContainer)==null||t.classList.add("fab-menu--visible")},10),console.log("[FabMenu] Menu expandido"))}collapse(){!this.menuContainer||!this.fabButton||(this.isExpanded=!1,this.menuContainer.classList.remove("fab-menu--visible"),this.fabButton.classList.remove("fab-button--expanded"),setTimeout(()=>{this.menuContainer&&(this.menuContainer.style.display="none")},300),console.log("[FabMenu] Menu colapsado"))}isMenuExpanded(){return this.isExpanded}}function z(l,t,e){return E?(console.warn("[FabMenu] Menu j√° inicializado"),E):(E=new x,E.init(l,t,e),E)}function M(l,t=!1){if(!l||!(l instanceof Date))return NaN;const e=new Date(l);t||e.setHours(12,0,0,0);const o=new Date(Date.UTC(1899,11,31,0,0,0)),a=1440*60*1e3;let s=(e.getTime()-o.getTime())/a;const n=new Date(Date.UTC(1900,1,28,0,0,0));return e>n&&(s+=1),Number(s.toFixed(10))}function b(l,t=!1){const e=Number(l);if(!Number.isFinite(e))return null;const o=e>=60?e-1:e,s=Date.UTC(1899,11,31)+o*864e5,n=new Date(s),r=n.getUTCFullYear(),i=n.getUTCMonth(),d=n.getUTCDate();if(!t)return new Date(r,i,d);const m=n.getUTCHours(),f=n.getUTCMinutes(),S=n.getUTCSeconds(),D=n.getUTCMilliseconds();return new Date(r,i,d,m,f,S,D)}function O(l){const t=b(l);if(!t)return String(l);const e=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${e}/${o}/${a}`}function V(l){const t=b(l,!0);if(!t)return String(l);const e=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear(),s=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return`${e}/${o}/${a} ${s}:${n}`}function P(l){if(!l)return null;const[t,e]=l.split("T");if(!t||!e)return null;const[o,a,s]=t.split("-").map(m=>parseInt(m,10)),n=e.split(":").map(m=>parseInt(m,10)),[r,i,d=0]=n;return new Date(o,a-1,s,r,i,d)}function H(l){if(!l)return null;const[t,e,o]=l.split("-").map(a=>parseInt(a,10));return!t||!e||!o?null:new Date(t,e-1,o,12,0,0,0)}function Y(l=-5,t=35){const e=new Date,o=new Date(e.getFullYear(),e.getMonth(),e.getDate()+l,0,0,0,0),a=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,23,59,59,999);return{startSerial:M(o),endSerial:M(a),startDate:o,endDate:a}}class L{async fetchEntries(t=100,e=!1){if(!c)throw new Error("PocketBase n√£o inicializado");if(!e){const o=w.SHEET_ENTRIES,a=v.get(o);if(a)return console.log("[LancamentosService] Usando dados do cache"),t>0&&a.entries&&a.entries.length>t?{...a,entries:a.entries.slice(0,t)}:a}try{console.log("[LancamentosService] Buscando dados do servidor");const o=await fetch(`${c.baseUrl}/get-sheet-entries?limit=${t}`,{method:"GET",headers:{Authorization:`Bearer ${c.authStore.token}`,"Content-Type":"application/json"}}),a=await o.json();if(!o.ok)throw new Error(a.error||"Erro ao carregar entradas da planilha");const s=w.SHEET_ENTRIES;return v.set(s,a),a}catch(o){throw console.error("Erro ao buscar entradas da planilha:",o),o}}invalidateCache(){console.log("[LancamentosService] Invalidando cache de lan√ßamentos"),v.clear(w.SHEET_ENTRIES)}async editEntry(t,e){if(!c)throw new Error("PocketBase n√£o inicializado");try{const o=await fetch(`${c.baseUrl}/edit-sheet-entry`,{method:"PUT",headers:{Authorization:`Bearer ${c.authStore.token}`,"Content-Type":"application/json"},body:JSON.stringify({rowIndex:t,...e})}),a=await o.json();if(!o.ok)throw new Error(a.error||"Erro ao editar lan√ßamento");return this.invalidateCache(),a}catch(o){throw console.error("Erro ao editar lan√ßamento:",o),o}}async deleteEntry(t){if(!c)throw new Error("PocketBase n√£o inicializado");try{const e=await fetch(`${c.baseUrl}/delete-sheet-entry`,{method:"DELETE",headers:{Authorization:`Bearer ${c.authStore.token}`,"Content-Type":"application/json"},body:JSON.stringify({rowIndex:t})}),o=await e.json();if(!e.ok)throw new Error(o.error||"Erro ao deletar lan√ßamento");return this.invalidateCache(),o}catch(e){throw console.error("Erro ao deletar lan√ßamento:",e),e}}isBlankEntry(t){return t?["data","conta","valor","descricao","categoria","orcamento","obs"].every(o=>{const a=t[o];return a==null?!0:typeof a=="number"?!1:String(a).trim()===""}):!0}normalizeEntry(t){const e={...t};if(typeof e.data=="number"){const o=b(e.data);o&&(e.data=o.toISOString())}if(typeof e.orcamento=="number"){const o=b(e.orcamento);o&&(e.orcamento=o.toISOString().split("T")[0])}return e}sortEntries(t,e){const o=[...t];return e==="original"?o.sort((a,s)=>(s.rowIndex||0)-(a.rowIndex||0)):e==="date"?o.sort((a,s)=>{const n=this.getDateValue(a.data);return this.getDateValue(s.data)-n}):e==="budget_date"?o.sort((a,s)=>{const n=this.getDateValue(a.orcamento),r=this.getDateValue(s.orcamento);if(n!==r)return r-n;const i=this.getDateValue(a.data);return this.getDateValue(s.data)-i}):o}getDateValue(t){if(!t)return Number.MAX_SAFE_INTEGER;if(typeof t=="number")return t;const e=new Date(t);return isNaN(e.getTime())?Number.MAX_SAFE_INTEGER:e.getTime()}filterEntries(t,e){if(!e||e.trim()==="")return t;const o=e.toLowerCase().trim();return t.filter(a=>{const s=this.formatDateForSearch(a.data),n=String(a.valor||""),r=String(a.descricao||"").toLowerCase(),i=String(a.categoria||"").toLowerCase(),d=String(a.conta||"").toLowerCase(),m=String(a.obs||"").toLowerCase();return s.includes(o)||n.includes(o)||r.includes(o)||i.includes(o)||d.includes(o)||m.includes(o)})}formatDateForSearch(t){if(!t)return"";let e=null;if(typeof t=="number"?e=b(t):e=new Date(t),!e||isNaN(e.getTime()))return"";const o=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),s=e.getFullYear();return`${o}/${a}/${s}`}getUniqueAccounts(t){const e=new Set;return t.forEach(o=>{o.conta&&typeof o.conta=="string"&&e.add(o.conta.trim())}),Array.from(e).sort()}getUniqueCategories(t){const e=new Set;return t.forEach(o=>{o.categoria&&typeof o.categoria=="string"&&e.add(o.categoria.trim())}),Array.from(e).sort()}getUniqueDescriptions(t){const e=new Set;return t.forEach(o=>{o.descricao&&typeof o.descricao=="string"&&e.add(o.descricao.trim())}),Array.from(e).sort()}}const R=new L;export{N as a,U as b,z as c,j as d,O as e,_ as f,Y as g,b as h,I as i,P as j,H as k,R as l,V as m,q as o,M as t};
